\documentclass[a4paper,11pt]{report}

\usepackage[french]{babel}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsfonts}
\usepackage{amsmath}
% \usepackage{cite}
\usepackage{natbib}
\usepackage{enumerate}
\usepackage{mathrsfs}
\usepackage[pdftex]{graphicx}
\usepackage[strings]{underscore} % for underscores in urls in bibtex
% \usepackage{appendix}
% \usepackage{todonotes}
% \usepackage[top=1in, bottom=1.5in, left=1.46in, right=1.46in]{geometry}
% \usepackage[pagebackref, linktocpage, colorlinks=true, breaklinks=true, linkcolor=blue]{hyperref}
% \usepackage[pagebackref, linktocpage, breaklinks=true, linkcolor=blue]{hyperref}

\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}

% \makeatletter
% \def\maketitle{%
  % \thispagestyle{empty}%
  % \begin{center}\leavevmode
    % \normalfont
    % {\LARGE UNIVERSITÉ CLAUDE BERNARD -- LYON 1\par}%
    % \vfill
    % {\Large \textbf{Master Recherche \og Physiologie et Neurosciences \fg}\par}%
    % \vskip 0.4cm
    % {\large Spécialité\par}%
    % \vskip 0.3cm
    % {\Large \textbf{Régulations Cardiovasculaires, Métaboliques et Nutritionnelles}\par}%
    % \vfill
    % {\Large \@date\par}%
    % \vfill
    % {\LARGE \@title\par}%
    % \vfill
    % {\Large Mémoire présenté par \@author\par}%
    % \vfill
    % {\large Travail réalisé dans le laboratoire\\
% CNRS FRE 3075 : Interactions Neurovasculaires\\
% ISPB -- Faculté de Pharmacie de Lyon\par}%
    % \vfill
    % {\Large Sous la direction du Pr. C. BARRÈS et du Dr. C. JULIEN}%
  % \end{center}%
  % \cleardoublepage
  % }
% \makeatother
\title{}
\author{Clément Gallet}
\date{}

% \setlength\belowcaptionskip{1cm}

\begin{document}

\pagenumbering{alph}

\pagestyle{empty}

\maketitle
\thispagestyle{empty}

\newpage


% ==========================
% Résumé
% ==========================



\section*{Résumé}

\newpage

\tableofcontents

\newpage

\pagestyle{plain}
\pagenumbering{arabic}
\setcounter{page}{1}




% ==========================
% Introduction
% ==========================

\chapter{Partie bibliographique}

\subsection{Introduction}

\section{Physiopathologie de la FA}

\subsection{Anatomie cardiaque}

Le c\{oe}ur est un organe dont la contraction assure la circulation du sang dans le système vasculaire. Il est constitué de deux parties séparées par une cloison musculaire appelée le septum, et chaque partie est composée de deux cavités : une oreillette et un ventricule. Un valve présente entre les deux cavités assure un passage unidirectionnel du sang de l'oreillette vers le ventricule. Le c\{oe}ur est relié au reste de la cirulation par un ensemble d'artères et de veines (Figure \ref{anatomie}). D'autres valves sont présentes entre le ventricule droit et l'artère pulmonaire, ainsi qu'entre le ventricule gauche et l'artère aorte, pour éviter un reflux sanguin vers le c\{oe}ur. La c\{oe}ur droit, contenant du sang pauvre en oxygène, amène le sang vers les poumons. La c\{oe}ur gauche, contenant du sang riche en oxygène, alimente le reste de l'organisme. 

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/anatomie.jpg}
	\caption{Schema anatomique du c\{oe}ur.}
	\label{anatomie}
\end{figure}

http://www.cardiologiedesenfants.be/bon-coeur-coeur-malade/coeur-normal/coeur-normal.html

Les parois du c\{oe}ur sont constituées principalement de cellules musculaires spécialisées appelées cardiomyocytes. La contraction organisée et périodique de ces cellules forme le battement cardiaque. Celui-ci est constitué de trois étapes :

\begin{description}
\item [La systole auriculaire :] les oreillettes se contractent et ejectent le sang dans les ventricules.
\item [La systole ventriculaire :] les ventricules se contractent et ejectent le sang vers le système vasculaire.
\item [La diastole :] le c\{oe}ur entier est relaxé pour permettre un remplissage sanguin.
\end{description}

La contraction cardiaque est déclenchée par une impulsion éléctrique qui se propage le long de fibres musculaires. Cette impulsion est générée par le n\{oe}ud sinusal, situé dans la paroi de l'oreillette droite. Elle parcourt ensuite les voies de conduction intra-auriculaires jusqu'au n\{oe}ud auriculo-ventriculaire, provoquant la contraction des oreillettes. Ce n\{oe}ud bloque l'impulsion pendant un court instant, puis la transmet au faisceau de His, puis aux fibres de Purkinje provoquant la contraction des ventricules (Figure \ref{conduction}).

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/conduction.gif}
	\caption{Schema des voies de conduction cardiaque.}
	\label{conduction}
\end{figure}

Le n\{oe}ud sinusal possède la propriété d'automaticité, elle se dépolarise à intervalles réguliers (définissant la période cardiaque) sans cause extérieure. Cependant, cette période cardiaque peut être modulée, principalement par l'action du système nerveux autonome.



\section{Détection automatique de la FA}

\subsection{Chez l'homme}

Chez l'homme, de nombreuses méthodes de détection automatique d'arythmies atriales, et en particulier la fibrillation atriale, ont été développées. Ces méthodes se sont surtout concentrées à la détection sur un enregistrement de Holter, dont la durée d'enregistrement ne permet pas une analyse visuelle exhaustive.

Lors d'une fibrillation atriale, le signal ECG présente deux principales caractéristiques qui sont à la base de deux catégories de méthodes :

\begin{itemize}
\item le rythme ventriculaire est rapide et irrégulier, donnant naissance à des méthodes basées sur l'analyse de l'intervalle RR
\item l'activité atriale est désordonnée, donnant naissance à des méthodes basées sur l'analyse de la forme des ondes
\end{itemize}

La grande majorité des méthodes se basent sur une même structure qui comprend quatre étapes :
\begin{enumerate}
\item prétraitement du signal ECG
\item calcul d'un ensemble de paramètres
\item réduction de l'ensemble des paramètres
\item classification à l'aide de l'ensemble des paramètres
\end{enumerate}

\subsubsection{Structure}

\paragraph{Prétraitement}

Avant la détection proprement dite des arythmies, le signal ECG subit une série de traitements qui vise à rendre possible ou à améliorer l'identification des arythmies.

Une première catégorie de traitements, qui n'est pas exclusive à la détection d'arythmies, consiste à réduire les différentes sources de bruit. Un signal ECG peut présenter une fluctuation de la ligne de base, une interférence avec l'électromyogramme ou des artefacts de mouvement. La méthode la plus simple de réduction de ces bruits consiste en un filtrage dans une certaine bande de fréquence \citep{aytemir99, yaghouby10, asl08}. Toutefois, cette méthode n'élimine que partiellement les différentes sources de bruit, car les composantes fréquentielles sont communes avec le signal ECG (Figure \ref{AS_ECG}, \citep{tompkins93}). D'autres méthodes plus complexes \citep{blanco08, afonso96, thakor91, kara07, kim09} permettent d'améliorer la réduction des bruits.

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/AS_ECG.png}
	\caption{Densité spectrale de puissance des complexes QRS, des ondes P et T et de plusieurs sources de bruit, après moyennage sur 150 battements (D'après \citet{tompkins93}).}
	\label{AS_ECG}
\end{figure}

Pour les méthodes se basant sur l'intervalle RR, il est nécessaire dans un deuxième temps de détecter les ondes R. De nombreuses méthodes existent pour effectuer cette détection \citep{kohler02}. Une des méthodes les plus utilisées est la méthode de \citet{pan85}. Cette méthode consiste à transformer le signal brut en un signal qui met en avant les complexes QRS. La transformation du signal est constituée de 4 étapes :
\begin{enumerate}
\item filtrage passe-bande (5-11 Hz)
\item dérivée
\item mise au carré
\item intégration par fenêtre mobile (150 ms)
\end{enumerate}

A partir du signal transformé, les pics sont détectés, ce qui donne la localisation des complexes QRS. La dernière étape consiste à détecter les ondes R sur le signal original comme les maxima à l'intérieur des complexes QRS (Figure \ref{QRSDetection}.

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/QRSDetection.png}
	\caption{Différentes étapes de l'algorithme de détection des QRS. (a) Signal original. (b) Résultat du filtre passe-bande. (c) Résultat de la dérivée. (d) Résultat de la mise au carré. (e) Résultat de l'intégration fenêtrée. (f) Signal original décalé pour compenser le décalage de l'ensemble des transformations. (g) Emplacement des complexes détectés. (D'après \citet{pan85}).}
	\label{QRSDetection}
\end{figure}


\paragraph{Extraction de paramètres}

Après traitement du signal, plusieurs paramètres sont calculés, étant susceptibles de prendre des valeurs différentes en fonction de la présence ou l'absence d'arythmies.

Une première famille de paramètres sont dérivés de l'intervalle RR. Le signal temporel constitué des intervalles RR successifs est caractérisé lors d'un épisode de fibrillation atriale par une irrégularité, qui peut être estimée à l'aide de différents indices. On retrouve les indices communs de variabilité sinusale comme le SDNN, le RMSSD ou la puissance spectrale dans certaines bandes de fréquence \citep{asl08, yaghouby10}. D'autres indices, non linéaires, sont aussi utilisés comme l'entropie \citep{staniczenko09, lake11, langley12}, l'exposant de Lyapunov ou les indices dérivés du tracé de Poincaré \citep{asl08} (Figure \ref{HRV_AF}).

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/HRV_AF.png}
	\caption{(a) Série temporelle d'intervalles RR provenant de la base de données MIT BIH Atrial Fibrillation, et l'annotation correspondante. En dessous, le calcul de trois indices dérivés des intervalles RR: (b) le rapport RMSSD sur la moyenne des intervalles RR, (c) un indice donnant la proportion de tournants sur 3 intervalles RR consécutifs (Turning Point Ratio) et (d) une estimation de l'entropie (Sample Entropy) (D'après \citet{dash09}).}
	\label{HRV_AF}
\end{figure}

La deuxième catégorie de paramètres quantifie la forme du tracé ECG. Une des analyses de forme la plus utilisée est la transformée en ondelettes. Celle-ci permet d'exprimer la forme du tracé par un ensemble restreint d'indices, donnant les caractéristiques du signal à différentes échelles (Figure \ref{Wavelets}) \citep{alfahoum99, ubeyli07}.

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/Wavelets.png}
	\caption{Un tracé ECG de fibrillation atriale, avec sa décomposition en ondelettes discrètes utilisant l'ondelette Daubechies 4. Les cinq premières composantes de la décomposition (d1-d5) sont illustrées, ainsi que le reste du signal (a5) (D'après \citet{alfahoum99}).}
	\label{Wavelets}
\end{figure}


\paragraph{Réduction de paramètres}

Certaines méthodes calculent un grand nombre de paramètres. Parmi ces paramètres, tous n'ont pas une égale importance. En effet, certains paramètres peuvent être redondants, d'autres peuvent avoir une faible puissance discriminative. Le fait d'avoir un très grand nombre de paramètres est néfaste pour l'étape de classification, en augmentant la complexité du modèle et en diminuant son efficacité. C'est pourquoi il peut être important de diminuer le nombre de paramètres.

Une méthode classique de réduction du nombre de paramètres est l'analyse en composantes principales \citep{pearson01}. Cette méthode géométrique permet de transformer un grand nombre de paramètres initiaux en un faible nombre de nouveaux paramètres appelées les composantes principales. Ces composantes principales ont deux caractéristiques : elles sont à la fois décorrélés les unes des autres, et elles conservent la plus grande partie de la variabilité initiale.

La première composante principale est définie par la direction de dispersion maximale des valeurs, et chaque composante principale successive est définie par la direction de dispersion maximale restante (non expliquée par les composantes précédentes) (Figure \ref{PCA}).

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/PCA.jpg}
	\caption{Analyse en composantes principales sur deux facteurs x et y. La première composante (v1) est définie par la direction de dispersion maximale des points, et la deuxième composante (v2), orthogonale à la première, explique le reste de la dispersion (D'après \citet{jehan05}).}
	\label{PCA}
\end{figure}

generalized discriminant analysis (GDA) [Asl08]
Improved forward floating selection (IFFS) [Yaghouby10]

\paragraph{Classification}

Les valeurs des paramètres sont ensuite utilisées pour classer le tracé ECG comme présentant une arythmie ou non. Les algorithmes de classification d'arythmies font généralement l'objet d'une phase d'apprentissage. L'algorithme est entrainé dans un premier temps sur des tracés dont la nature de l'arythmie est connue, pour en déterminer les caractéristiques. Ensuite, l'algorithme est appliqué sur des tracés ECG de nature inconnue pour les classer.

Un exemple d'algorithme de classification est la machine à vecteur de support \citep{jovic12, ubeyli07, asl08}. Cette méthode est basée sur une représentation géométrique de l'ensemble des paramètres. Les valeurs des paramètres représentent les coordonnées d'un point dans un espace. Lors de la phase d'apprentissage, on obtient groupes de points, selon que le tracé ECG correspondant présente une arythmie ou non. Si le choix des paramètres est judicieux, les deux groupes de points sont séparés dans l'espace. Dans la version simple de l'algorithme, il est supposé que les groupes de points de chaque catégorie sont linéairement séparables (par une droite dans un espace à deux dimensions, par un plan dans un espace à trois dimensions, etc.). L'algorithme détermine alors la meilleure frontière entre les deux groupes de points, celle dont la marge est maximale (Figure \ref{SVM1}). La marge est définie comme la zone autour de la frontière qui ne contient aucun point. Lors de la phase de classification, cette frontière est utilisée pour classer les points dans l'une ou l'autre des catégories.

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/SVM1.jpg}
	\caption{Graphe représentant deux groupes selon les valeurs de deux paramètres. La frontière déterminée par l'algorithme de machine à vecteurs de support est la frontière séparant les deux groupes, telle que la marge possède une largeur maximale. Les points situés au bord de la marge sont appelés les vecteurs de support (D'après \citet{winters07}).}
	\label{SVM1}
\end{figure}

En pratique, les groupes de points sont rarement linéairement séparables. Pour pouvoir séparer les groupes, les points sont projetés dans un nouvel espace de plus grande dimension, où les groupes de points sont plus susceptibles d'être linéairement séparables (Figure \ref{SVM2}).

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/SVM2.jpg}
	\caption{Graphes représentant deux groupes selon les valeurs de deux paramètres (a) et une combinaison des deux paramètres (b). Dans le premier graphe, les deux groupes ne sont pas linéairement séparables. Dans le deuxième graphe, après une recombinaison des paramètres, les deux groupes sont linéairement séparables. (D'après \citet{verplancke08}).}
	\label{SVM2}
\end{figure}

- refs svm af: Detection of atrial fibrillation episodes using SVM; Support Vector Machine Classifier with Feature Extraction Stage as an Efficient Tool for Atrial Fibrillation Detection Improvement

- reseaux de neurones [Kara07]

\subsubsection{Validation et performance}

Après avoir mis au point un algorithme de détection d'arythmies, il est nécessaire d'évaluer sa performance. Pour cela, les résultats de l'algorithme sont comparés avec le diagnostic d'un spécialiste. Cela requiert d'avoir des tracés ECG annotés, en nombre suffisant pour pouvoir estimer correctement la performance de l'algorithme.

La solution majoritairement utilisée consiste à se servir de bases de données en libre accès, et en particulier la banque PhysioBank \citep{PhysioNet}. Cette banque contient des bases de données d'enregistrements de signaux physiologiques chez des patients sains ou atteints de diverses pathologies. La base de données MIT-BIH Atrial Fibrillation Database est utilisée en particulier, présentant 23 enregistrements Holter de 10 heures contenant des épisodes de fibrillation atriale paroxystique, et incluant les annotations des différentes arythmies. L'avantage d'utiliser une base de données centrale est que les résultats de différents algorithmes peuvent être comparés entre eux \citep{yaghouby10, jovic12}. Par contre, plusieurs études sont en désaccord avec certaines annotations présentes dans ces bases de données \citep{tateno00, staniczenko09}.

La quantification de la performance d'un algorithme se fait dans un premier temps par le décompte des bonnes et mauvaises détections. Sont décomptés le nombre de cas arythmiques détectés comme arythmiques (VP, vrais positifs), le nombre de cas arythmiques détectés comme non arythmiques (FN, faux négatifs), le nombre de cas non arythmiques détectés comme arythmiques (FP, faux positifs) et le nombre de cas non arythmiques détectés comme non arythmiques (VN, vrais négatifs). A partir de ces quatre valeurs, les indices de sensibilité (VP/(VP+FN)), de spécificité (VN/(VN+FP)) ou de valeur prédictive positive (VP/(VP+FP)) sont généralement calculés pour apprécier la performance de l'algorithme. La sensibilité peut être interprétée comme la probabilité de détecter une arythmie lorsqu'elle est présente, et la spécificité comme la probabilité de détecter un rythme sinusal lorsqu'il est présent. Ce deuxième indice est souvent remplacé par la valeur prédictive positive, qui correspond à la probabilité qu'une arythmie détectée soit correcte. Toutefois, au contraire des deux premiers indices, la valeur positive prédictive dépend de la prévalence de l'arythmie \citep{koeppel12}. Dans la plupart des études, les valeurs de ces indices sont supérieures à 0,90.


\subsection{Chez le rat}


Dans une première catégorie d'études, les arythmies sont détectées visuellement. C'est le cas dans les études où la période d'analyse est courte, comme après un entrainement atrial \citep{haugan04} ou la ligature d'une artère coronaire \citep{baltogiannis05}. D'autres études, lorsque la période d'analyse est plus longue, segmentent les enregistrements et analysent uniquement certains segments \citep{nadziejko04, koeppel12}. La détection des ondes R et le calcul des intervalles RR peuvent aider à la détection, notamment en fixant des seuils. Par exemple, dans l'étude de \citet{opitz95}, les arythmies sont recherchées visuellement lorsque l'intervalle RR (converti en fréquence cardiaque) sort de l'intervalle 300-500 bpm. L'analyse visuelle montre ses limites dans l'étude de \citet{carre92}, où le trop grand nombre d'arythmies supraventriculaires empeche un comptage exhaustif (Figure \ref{esarat}).

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/ecgratcarre.png}
	\caption{Tracé ECG chez un rat controle sénescent (22 mois), montrant un grand nombre d'extrasystoles supraventriculaires (D'après \citet{carre92}).}
	\label{esarat}
\end{figure}


Dans le cas d'enregistrements télémétriques de longue durée, plusieurs études utilisent des logiciels commerciaux pour la détection d'arythmies \citep{boixel03, lyon11, milliez05, anselme07, farraj09}. Au moins trois logiciels proposent l'analyse de tracés ECG chez le rat : LabChart (ADInstruments) avec le module ECG Analysis \citep{labchart}, ecgAUTO (emka TECHNOLOGIES) \citep{ecgauto} et ARR30a (NOTOCORD) \citep{arr30a} (Figures \ref{ecgauto}-\ref{arr30a}. Le logiciel de NOTOCORD permis de réaliser une étude qui analyse des tracés ECG dans cinq espèces (primate, chien, cochon, cobaye et rat) \citep{koeppel12}. L'étude compare l'analyse visuelle avec la détection automatique fournie par le logiciel, qui permet de détecter cinq types d'arythmies. Cette étude rapporte une plus grande difficulté à traiter les tracés ECG de rat par rapport à ceux d'autres espèces, notamment du fait de la présence d'ondes P de faible amplitude. De même, la majorité des arythmies présentes sont des arythmies ventriculaires, seuls 40 battements ectopiques d'origine atriale sont présents. Pour ces trois logiciels du commerce, la méthode utilisée pour la détection des arythmies n'est pas décrite précisément. Il est juste indiqué que les logiciels utilisent à la fois la forme des ondes et la variation des intervalles RR pour classer les tracés. Une seule étude a comparé l'analyse ECG des logiciels de ces trois sociétés \citep{chui09}, chez le chien, mais cette étude n'inclut pas la détection d'arythmies.

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/ecgAUTO.png}
	\caption{Capture du logiciel ecgAUTO traitant une enregistrement ECG chez le chien.}
	\label{ecgauto}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/ARR30a.png}
	\caption{Capture du logiciel ARR30a.}
	\label{arr30a}
\end{figure}


Les études développant un algorithme personnalisé entièrement automatisé de détection des arythmies sont très rares. L'équipe de \citet{sgoifo94, sgoifo97} a développé une méthode basée sur les intervalles RR chez le rat, mais sans décrire cette méthode. De même, l'équipe de \citet{london03} a développé un algorithme de détection après avoir analysé des tracés ECG chez la souris, sans description de cette méthode.

Chez le chien, une méthode de détection basée sur la forme des ondes est décrite \cite{sugiura98}, mais elle concerne uniquement les arythmies ventriculaires.

Chez le rat, une étude montre une application de la dynamique symbolique à la détection des arythmies \citep{letellier04}. Les intervalles RR sont classés dans trois groupes, chaque groupe étant représenté par un symbole : RR court = 0, RR normal = 1, RR long = 2. La série des intervalles RR successifs est alors converti en une suite de symboles. Une extrasystole étant caractérisée par un intervalle RR court suivi d'un intervalle RR long, la séquence de symboles correspondante est $...11102111...$.

En considérant les séquences ayant une longueur de 5 symboles, il existe 243 combinaisons possibles. En comptant le nombre d'occurences de chaque séquence, on obtient une répartition permettant de dresser un profil arythmique (Figure \ref{symbolic}).

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{images/symbolic.PNG}
	\caption{Nombre d'occurrences de chaque séquence de cinq symboles chez un rat controle et un rat atteint d'une insuffisance cardiaque}
	\label{symbolic}
\end{figure}

Cette méthode permet de montrer le profil arythmique global d'un tracé ECG, mais ne permet pas de détecter individuellement chaque arythmie. De plus, le choix des bornes pour classer les intervalles RR n'est pas explicité.


- Baltogiannis05 : rat, VF+VT, visual
- Nadziejko04 : rat, many, visual
- Haugan04 : rat, AF, visual

- boixel03 : rat, AF, Chart v4.1.2' (PowerLab, AdInstruments, Colo-rado Springs, Colorado)
- Lyon11 : rat, VF, ECG-Auto  2.4  software
- Milliez05 : rat, ESA, ECG-Auto software (EMKA technologies, France)
- Anselme07 : rat, ESV, EMKA ECG-Auto 1.5.12.0
- Farraj09 : rat, many, ECGAuto software (EMKA Technologies) 

- Opitz95 : rat, VT-VF, custom (<300 ou >500 bpm).
- Sgoifo97 : rat, many, custom
sgoifo94

- Chui09 : comparaison entre 3 softs (pas d'arymthies).
- London03 : souris, many, visual + custom [tracé AF souris]
- London98 : souris, V, visual
- Ouvrard05 : souris, ESV-VT, ECG-Auto program (EMKA Technologies)


Automatic discrimination of arrhythmia waveforms using fuzzy logic (chien)

\section{A mettre}

Figure1 Taneto01 (ou Tateno00 !) pour illustration de la limitation de considérer un segment d'intervalle RR.

\addcontentsline{toc}{section}{Références}
% \bibliographystyle{these}
\bibliographystyle{plainnat}
\bibliography{thesis}

\end{document}